<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.31.1">
    <meta name="project" content="kernel v9.3">


    <title>gen_tcp — kernel v9.3</title>
    <link rel="stylesheet" href="dist/html-erlang-YUARVD4J.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-43PMFBC7.js"></script>
    <script src="dist/sidebar_items-D60EFF5E.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-L4O5OK2K.js"></script>

<style>.dark img { background-color: white; }</style>
  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<div class="background-layer"></div>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="kernel" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
kernel
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v9.3
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">
      <div class="top-search">
        <div class="search-settings">
          <form class="search-bar" action="search.html">
            <label class="search-label">
              <span class="sr-only">Search documentation of kernel</span>
              <input name="q" type="text" class="search-input" placeholder="Search Documentation (press /)" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
            </label>
            <button type="submit" class="search-button" aria-label="Submit Search">
              <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
            </button>
            <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
              <i class="ri-close-line ri-lg" title="Cancel search"></i>
            </button>
          </form>
          <div class="autocomplete">
          </div>
          <button class="icon-settings display-settings">
            <i class="ri-settings-3-line"></i>
            <span class="sr-only">Settings</span>
          </button>
        </div>

      </div>

<h1>

    <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L21" title="View Source" class="icon-action" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span translate="no">gen_tcp</span> 
  <small class="app-vsn" translate="no">(kernel v9.3)</small>

</h1>


  <section id="moduledoc">
<p>Interface to TCP/IP sockets.</p><p>This module provides functions for communicating with sockets using the TCP/IP
protocol.</p><p>The following code fragment is a simple example of a client connecting to a
server at port 5678, transferring a binary, and closing the connection:</p><pre><code class="makeup erlang" translate="no"><span class="nf">client</span><span class="p" data-group-id="7878787825-1">(</span><span class="p" data-group-id="7878787825-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">SomeHostInNet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">% to make it runnable on one machine</span><span class="w">
    </span><span class="p" data-group-id="7878787825-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Sock</span><span class="p" data-group-id="7878787825-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">connect</span><span class="p" data-group-id="7878787825-3">(</span><span class="n">SomeHostInNet</span><span class="p">,</span><span class="w"> </span><span class="mi">5678</span><span class="p">,</span><span class="w">
                                 </span><span class="p" data-group-id="7878787825-4">[</span><span class="ss">binary</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7878787825-5">{</span><span class="ss">packet</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="7878787825-5">}</span><span class="p" data-group-id="7878787825-4">]</span><span class="p" data-group-id="7878787825-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="7878787825-6">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Some Data&quot;</span><span class="p" data-group-id="7878787825-6">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="7878787825-7">(</span><span class="n">Sock</span><span class="p" data-group-id="7878787825-7">)</span><span class="p">.</span></code></pre><p>At the other end, a server is listening on port 5678, accepts the connection,
and receives the binary:</p><pre><code class="makeup erlang" translate="no"><span class="nf">server</span><span class="p" data-group-id="1221802193-1">(</span><span class="p" data-group-id="1221802193-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="1221802193-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">LSock</span><span class="p" data-group-id="1221802193-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">listen</span><span class="p" data-group-id="1221802193-3">(</span><span class="mi">5678</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1221802193-4">[</span><span class="ss">binary</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1221802193-5">{</span><span class="ss">packet</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1221802193-5">}</span><span class="p">,</span><span class="w">
                                        </span><span class="p" data-group-id="1221802193-6">{</span><span class="ss">active</span><span class="p">,</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="1221802193-6">}</span><span class="p" data-group-id="1221802193-4">]</span><span class="p" data-group-id="1221802193-3">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1221802193-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Sock</span><span class="p" data-group-id="1221802193-7">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">accept</span><span class="p" data-group-id="1221802193-8">(</span><span class="n">LSock</span><span class="p" data-group-id="1221802193-8">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1221802193-9">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Bin</span><span class="p" data-group-id="1221802193-9">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">do_recv</span><span class="p" data-group-id="1221802193-10">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1221802193-11">[</span><span class="p" data-group-id="1221802193-11">]</span><span class="p" data-group-id="1221802193-10">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="1221802193-12">(</span><span class="n">Sock</span><span class="p" data-group-id="1221802193-12">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="1221802193-13">(</span><span class="n">LSock</span><span class="p" data-group-id="1221802193-13">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Bin</span><span class="p">.</span><span class="w">

</span><span class="nf">do_recv</span><span class="p" data-group-id="1221802193-14">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="n">Bs</span><span class="p" data-group-id="1221802193-14">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">recv</span><span class="p" data-group-id="1221802193-15">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="1221802193-15">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="1221802193-16">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p" data-group-id="1221802193-16">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nf">do_recv</span><span class="p" data-group-id="1221802193-17">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1221802193-18">[</span><span class="n">Bs</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p" data-group-id="1221802193-18">]</span><span class="p" data-group-id="1221802193-17">)</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="1221802193-19">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">closed</span><span class="p" data-group-id="1221802193-19">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="1221802193-20">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="nf">list_to_binary</span><span class="p" data-group-id="1221802193-21">(</span><span class="n">Bs</span><span class="p" data-group-id="1221802193-21">)</span><span class="p" data-group-id="1221802193-20">}</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><p>For more examples, see section <a href="gen_tcp.html#module-examples">Examples</a>.</p><blockquote><h4 class="info">Note</h4><p>Functions that create sockets can take an optional option;
<code class="inline">{inet_backend, Backend}</code> that, if specified, has to be the first option. This
selects the implementation backend towards the platform's socket API.</p><p>This is a <em>temporary</em> option that will be ignored in a future release.</p><p>The default is <code class="inline">Backend = inet</code> that selects the traditional <code class="inline">inet_drv.c</code>
driver. The other choice is <code class="inline">Backend = socket</code> that selects the new <a href="socket.html"><code class="inline">socket</code></a>
module and its NIF implementation.</p><p>The system default can be changed when the node is started with the
application <code class="inline">kernel</code>'s configuration variable <code class="inline">inet_backend</code>.</p><p>For <code class="inline">gen_tcp</code> with <code class="inline">inet_backend = socket</code> we have tried to be as &quot;compatible&quot;
as possible which has sometimes been impossible. Here is a list of cases when
the behaviour of inet-backend <code class="inline">inet</code> (default) and <code class="inline">socket</code> are different:</p><ul><li><p><a href="gen_tcp.html#non_blocking_send">Non-blocking send</a></p><p>If a user calling <a href="#send/2"><code class="inline">gen_tcp:send/2</code></a> with <code class="inline">inet_backend = inet</code>,
tries to send more data than there is room for in the OS buffers, the &quot;rest
data&quot; is buffered by the inet driver (and later sent in the background). The
effect for the user is that the call is non-blocking.</p><p>This is <em>not</em> the effect when <code class="inline">inet_backend = socket</code>, since there is no
buffering. Instead the user hangs either until all data has been sent or the
<code class="inline">send_timeout</code> timeout has been reached.</p></li><li><p><a href="#shutdown/2"><code class="inline">shutdown/2</code></a> may hide errors</p><p>The call does not involve the receive process state, and is done
right on the underlying socket.  On for example Linux, it is a known
misbehaviour that it skips some checks so doing shutdown on a
listen socket returns <code class="inline">ok</code> while the logical result should have been
<code class="inline">{error, enotconn}</code>.  The <code class="inline">inet_drv.c</code> driver did an extra check
and simulated the correct error, but with <code class="inline">Backend = socket</code>
it would introduce overhead to involve the receive process.</p></li><li><p>The option <a href="inet.html#option-nodelay">nodelay</a> is a TCP specific option that
is <em>not</em> compatible with <code class="inline">domain = local</code>.</p><p>When using <code class="inline">inet_backend = socket</code>, trying to create a socket (via listen or
connect) with <code class="inline">domain = local</code> (for example with option {ifaddr,
{local,&quot;/tmp/test&quot;}}) <em>will fail</em> with <code class="inline">{error, enotsup}</code>.</p><p>This does not actually work for <code class="inline">inet_backend = inet</code> either, but in that
case the error is simply <em>ignored</em>, which is a <em>bad</em> idea. We have chosen to
<em>not</em> ignore this error for <code class="inline">inet_backend = socket</code>.</p></li><li><p><a href="gen_tcp.html#async_shutdown_write">Async shutdown write</a></p><p>Calling <a href="#shutdown/2">gen_tcp:shutdown(Socket, write | read_write)</a> on a
socket created with <code class="inline">inet_backend = socket</code> will take <em>immediate</em> effect,
unlike for a socket created with <code class="inline">inet_backend = inet</code>.</p><p>See <a href="gen_tcp.html#async_shutdown_write">async shutdown write</a> for more info.</p></li><li><p>Windows require sockets (domain = <code class="inline">inet | inet6</code>) to be bound.</p><p><em>Currently</em> all sockets created on Windows with <code class="inline">inet_backend = socket</code> will
be bound. If the user does not provide an address, gen_tcp will try to
'figure out' an address itself.</p></li></ul></blockquote><h2 id="module-examples" class="section-heading">
  <a href="#module-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<p><a href="" id="examples"></a></p><p>The following example illustrates use of option <code class="inline">{active,once}</code> and multiple
accepts by implementing a server as a number of worker processes doing accept on
a single listening socket. Function <code class="inline">start/2</code> takes the number of worker
processes and the port number on which to listen for incoming connections. If
<code class="inline">LPort</code> is specified as <code class="inline">0</code>, an ephemeral port number is used, which is why the
start function returns the actual port number allocated:</p><pre><code class="makeup erlang" translate="no"><span class="nf">start</span><span class="p" data-group-id="9036111911-1">(</span><span class="n">Num</span><span class="p">,</span><span class="n">LPort</span><span class="p" data-group-id="9036111911-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">listen</span><span class="p" data-group-id="9036111911-2">(</span><span class="n">LPort</span><span class="p">,</span><span class="p" data-group-id="9036111911-3">[</span><span class="p" data-group-id="9036111911-4">{</span><span class="ss">active</span><span class="p">,</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="9036111911-4">}</span><span class="p">,</span><span class="p" data-group-id="9036111911-5">{</span><span class="ss">packet</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="9036111911-5">}</span><span class="p" data-group-id="9036111911-3">]</span><span class="p" data-group-id="9036111911-2">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="9036111911-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">ListenSock</span><span class="p" data-group-id="9036111911-6">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nf">start_servers</span><span class="p" data-group-id="9036111911-7">(</span><span class="n">Num</span><span class="p">,</span><span class="n">ListenSock</span><span class="p" data-group-id="9036111911-7">)</span><span class="p">,</span><span class="w">
            </span><span class="p" data-group-id="9036111911-8">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Port</span><span class="p" data-group-id="9036111911-8">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">inet</span><span class="p">:</span><span class="nf">port</span><span class="p" data-group-id="9036111911-9">(</span><span class="n">ListenSock</span><span class="p" data-group-id="9036111911-9">)</span><span class="p">,</span><span class="w">
            </span><span class="n">Port</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="9036111911-10">{</span><span class="ss">error</span><span class="p">,</span><span class="n">Reason</span><span class="p" data-group-id="9036111911-10">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="9036111911-11">{</span><span class="ss">error</span><span class="p">,</span><span class="n">Reason</span><span class="p" data-group-id="9036111911-11">}</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="nf">start_servers</span><span class="p" data-group-id="9036111911-12">(</span><span class="mi">0</span><span class="p">,</span><span class="p">_</span><span class="p" data-group-id="9036111911-12">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="ss">ok</span><span class="p">;</span><span class="w">
</span><span class="nf">start_servers</span><span class="p" data-group-id="9036111911-13">(</span><span class="n">Num</span><span class="p">,</span><span class="n">LS</span><span class="p" data-group-id="9036111911-13">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">spawn</span><span class="p" data-group-id="9036111911-14">(</span><span class="o">?</span><span class="n">MODULE</span><span class="p">,</span><span class="ss">server</span><span class="p">,</span><span class="p" data-group-id="9036111911-15">[</span><span class="n">LS</span><span class="p" data-group-id="9036111911-15">]</span><span class="p" data-group-id="9036111911-14">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">start_servers</span><span class="p" data-group-id="9036111911-16">(</span><span class="n">Num</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">LS</span><span class="p" data-group-id="9036111911-16">)</span><span class="p">.</span><span class="w">

</span><span class="nf">server</span><span class="p" data-group-id="9036111911-17">(</span><span class="n">LS</span><span class="p" data-group-id="9036111911-17">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">accept</span><span class="p" data-group-id="9036111911-18">(</span><span class="n">LS</span><span class="p" data-group-id="9036111911-18">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="9036111911-19">{</span><span class="ss">ok</span><span class="p">,</span><span class="n">S</span><span class="p" data-group-id="9036111911-19">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nf">loop</span><span class="p" data-group-id="9036111911-20">(</span><span class="n">S</span><span class="p" data-group-id="9036111911-20">)</span><span class="p">,</span><span class="w">
            </span><span class="nf">server</span><span class="p" data-group-id="9036111911-21">(</span><span class="n">LS</span><span class="p" data-group-id="9036111911-21">)</span><span class="p">;</span><span class="w">
        </span><span class="n">Other</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="9036111911-22">(</span><span class="s">&quot;accept returned </span><span class="si">~w</span><span class="s"> - goodbye!</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="p" data-group-id="9036111911-23">[</span><span class="n">Other</span><span class="p" data-group-id="9036111911-23">]</span><span class="p" data-group-id="9036111911-22">)</span><span class="p">,</span><span class="w">
            </span><span class="ss">ok</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="nf">loop</span><span class="p" data-group-id="9036111911-24">(</span><span class="n">S</span><span class="p" data-group-id="9036111911-24">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">inet</span><span class="p">:</span><span class="nf">setopts</span><span class="p" data-group-id="9036111911-25">(</span><span class="n">S</span><span class="p">,</span><span class="p" data-group-id="9036111911-26">[</span><span class="p" data-group-id="9036111911-27">{</span><span class="ss">active</span><span class="p">,</span><span class="ss">once</span><span class="p" data-group-id="9036111911-27">}</span><span class="p" data-group-id="9036111911-26">]</span><span class="p" data-group-id="9036111911-25">)</span><span class="p">,</span><span class="w">
    </span><span class="k">receive</span><span class="w">
        </span><span class="p" data-group-id="9036111911-28">{</span><span class="ss">tcp</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Data</span><span class="p" data-group-id="9036111911-28">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="n">Answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">process</span><span class="p" data-group-id="9036111911-29">(</span><span class="n">Data</span><span class="p" data-group-id="9036111911-29">)</span><span class="p">,</span><span class="w"> </span><span class="c1">% Not implemented in this example</span><span class="w">
            </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="9036111911-30">(</span><span class="n">S</span><span class="p">,</span><span class="n">Answer</span><span class="p" data-group-id="9036111911-30">)</span><span class="p">,</span><span class="w">
            </span><span class="nf">loop</span><span class="p" data-group-id="9036111911-31">(</span><span class="n">S</span><span class="p" data-group-id="9036111911-31">)</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="9036111911-32">{</span><span class="ss">tcp_closed</span><span class="p">,</span><span class="n">S</span><span class="p" data-group-id="9036111911-32">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="9036111911-33">(</span><span class="s">&quot;Socket </span><span class="si">~w</span><span class="s"> closed [</span><span class="si">~w</span><span class="s">]</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="p" data-group-id="9036111911-34">[</span><span class="n">S</span><span class="p">,</span><span class="nf">self</span><span class="p" data-group-id="9036111911-35">(</span><span class="p" data-group-id="9036111911-35">)</span><span class="p" data-group-id="9036111911-34">]</span><span class="p" data-group-id="9036111911-33">)</span><span class="p">,</span><span class="w">
            </span><span class="ss">ok</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><p>Example of a simple client:</p><pre><code class="makeup erlang" translate="no"><span class="nf">client</span><span class="p" data-group-id="8421047698-1">(</span><span class="n">PortNo</span><span class="p">,</span><span class="n">Message</span><span class="p" data-group-id="8421047698-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="8421047698-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="n">Sock</span><span class="p" data-group-id="8421047698-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">connect</span><span class="p" data-group-id="8421047698-3">(</span><span class="s">&quot;localhost&quot;</span><span class="p">,</span><span class="n">PortNo</span><span class="p">,</span><span class="p" data-group-id="8421047698-4">[</span><span class="p" data-group-id="8421047698-5">{</span><span class="ss">active</span><span class="p">,</span><span class="ss">false</span><span class="p" data-group-id="8421047698-5">}</span><span class="p">,</span><span class="w">
                                                    </span><span class="p" data-group-id="8421047698-6">{</span><span class="ss">packet</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="8421047698-6">}</span><span class="p" data-group-id="8421047698-4">]</span><span class="p" data-group-id="8421047698-3">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="8421047698-7">(</span><span class="n">Sock</span><span class="p">,</span><span class="n">Message</span><span class="p" data-group-id="8421047698-7">)</span><span class="p">,</span><span class="w">
    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">recv</span><span class="p" data-group-id="8421047698-8">(</span><span class="n">Sock</span><span class="p">,</span><span class="mi">0</span><span class="p" data-group-id="8421047698-8">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="8421047698-9">(</span><span class="n">Sock</span><span class="p" data-group-id="8421047698-9">)</span><span class="p">,</span><span class="w">
    </span><span class="n">A</span><span class="p">.</span></code></pre><p>The <code class="inline">send</code> call does not accept a time-out option because time-outs on send is
handled through socket option <code class="inline">send_timeout</code>. The behavior of a send operation
with no receiver is mainly defined by the underlying TCP stack and the network
infrastructure. To write code that handles a hanging receiver that can
eventually cause the sender to hang on a <code class="inline">send</code> do like the following.</p><p>Consider a process that receives data from a client process to be forwarded to a
server on the network. The process is connected to the server through TCP/IP and
does not get any acknowledge for each message it sends, but has to rely on the
send time-out option to detect that the other end is unresponsive. Option
<code class="inline">send_timeout</code> can be used when connecting:</p><pre><code class="makeup erlang" translate="no"><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="3979213162-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="n">Sock</span><span class="p" data-group-id="3979213162-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">connect</span><span class="p" data-group-id="3979213162-2">(</span><span class="n">HostAddress</span><span class="p">,</span><span class="w"> </span><span class="n">Port</span><span class="p">,</span><span class="w">
                            </span><span class="p" data-group-id="3979213162-3">[</span><span class="p" data-group-id="3979213162-4">{</span><span class="ss">active</span><span class="p">,</span><span class="ss">false</span><span class="p" data-group-id="3979213162-4">}</span><span class="p">,</span><span class="w">
                             </span><span class="p" data-group-id="3979213162-5">{</span><span class="ss">send_timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="3979213162-5">}</span><span class="p">,</span><span class="w">
                             </span><span class="p" data-group-id="3979213162-6">{</span><span class="ss">packet</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="3979213162-6">}</span><span class="p" data-group-id="3979213162-3">]</span><span class="p" data-group-id="3979213162-2">)</span><span class="p">,</span><span class="w">
                </span><span class="nf">loop</span><span class="p" data-group-id="3979213162-7">(</span><span class="n">Sock</span><span class="p" data-group-id="3979213162-7">)</span><span class="p">,</span><span class="w"> </span><span class="c1">% See below</span><span class="w">
</span><span class="p">.</span><span class="p">.</span><span class="p">.</span></code></pre><p>In the loop where requests are handled, send time-outs can now be detected:</p><pre><code class="makeup erlang" translate="no"><span class="nf">loop</span><span class="p" data-group-id="3257378869-1">(</span><span class="n">Sock</span><span class="p" data-group-id="3257378869-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">receive</span><span class="w">
        </span><span class="p" data-group-id="3257378869-2">{</span><span class="n">Client</span><span class="p">,</span><span class="w"> </span><span class="ss">send_data</span><span class="p">,</span><span class="w"> </span><span class="n">Binary</span><span class="p" data-group-id="3257378869-2">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="k">case</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="3257378869-3">(</span><span class="n">Sock</span><span class="p">,</span><span class="p" data-group-id="3257378869-4">[</span><span class="n">Binary</span><span class="p" data-group-id="3257378869-4">]</span><span class="p" data-group-id="3257378869-3">)</span><span class="w"> </span><span class="k">of</span><span class="w">
                </span><span class="p" data-group-id="3257378869-5">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">timeout</span><span class="p" data-group-id="3257378869-5">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="3257378869-6">(</span><span class="s">&quot;Send timeout, closing!</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w">
                              </span><span class="p" data-group-id="3257378869-7">[</span><span class="p" data-group-id="3257378869-7">]</span><span class="p" data-group-id="3257378869-6">)</span><span class="p">,</span><span class="w">
                    </span><span class="nf">handle_send_timeout</span><span class="p" data-group-id="3257378869-8">(</span><span class="p" data-group-id="3257378869-8">)</span><span class="p">,</span><span class="w"> </span><span class="c1">% Not implemented here</span><span class="w">
                    </span><span class="n">Client</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="3257378869-9">{</span><span class="nf">self</span><span class="p" data-group-id="3257378869-10">(</span><span class="p" data-group-id="3257378869-10">)</span><span class="p">,</span><span class="p" data-group-id="3257378869-11">{</span><span class="ss">error_sending</span><span class="p">,</span><span class="w"> </span><span class="ss">timeout</span><span class="p" data-group-id="3257378869-11">}</span><span class="p" data-group-id="3257378869-9">}</span><span class="p">,</span><span class="w">
                    </span><span class="c1">%% Usually, it&#39;s a good idea to give up in case of a</span><span class="w">
                    </span><span class="c1">%% send timeout, as you never know how much actually</span><span class="w">
                    </span><span class="c1">%% reached the server, maybe only a packet header?!</span><span class="w">
                    </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="3257378869-12">(</span><span class="n">Sock</span><span class="p" data-group-id="3257378869-12">)</span><span class="p">;</span><span class="w">
                </span><span class="p" data-group-id="3257378869-13">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">OtherSendError</span><span class="p" data-group-id="3257378869-13">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="3257378869-14">(</span><span class="s">&quot;Some other error on socket (</span><span class="si">~p</span><span class="s">), closing&quot;</span><span class="p">,</span><span class="w">
                              </span><span class="p" data-group-id="3257378869-15">[</span><span class="n">OtherSendError</span><span class="p" data-group-id="3257378869-15">]</span><span class="p" data-group-id="3257378869-14">)</span><span class="p">,</span><span class="w">
                    </span><span class="n">Client</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="3257378869-16">{</span><span class="nf">self</span><span class="p" data-group-id="3257378869-17">(</span><span class="p" data-group-id="3257378869-17">)</span><span class="p">,</span><span class="p" data-group-id="3257378869-18">{</span><span class="ss">error_sending</span><span class="p">,</span><span class="w"> </span><span class="n">OtherSendError</span><span class="p" data-group-id="3257378869-18">}</span><span class="p" data-group-id="3257378869-16">}</span><span class="p">,</span><span class="w">
                    </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="3257378869-19">(</span><span class="n">Sock</span><span class="p" data-group-id="3257378869-19">)</span><span class="p">;</span><span class="w">
                </span><span class="ss">ok</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="n">Client</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="3257378869-20">{</span><span class="nf">self</span><span class="p" data-group-id="3257378869-21">(</span><span class="p" data-group-id="3257378869-21">)</span><span class="p">,</span><span class="w"> </span><span class="ss">data_sent</span><span class="p" data-group-id="3257378869-20">}</span><span class="p">,</span><span class="w">
                    </span><span class="nf">loop</span><span class="p" data-group-id="3257378869-22">(</span><span class="n">Sock</span><span class="p" data-group-id="3257378869-22">)</span><span class="w">
            </span><span class="k">end</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><p>Usually it suffices to detect time-outs on receive, as most protocols include
some sort of acknowledgment from the server, but if the protocol is strictly one
way, option <code class="inline">send_timeout</code> comes in handy.</p>
  </section>


  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:connect_option/0" translate="no">connect_option()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:listen_option/0" translate="no">listen_option()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:option/0" translate="no">option()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:option_name/0" translate="no">option_name()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:pktoptions_value/0" translate="no">pktoptions_value()</a>

      </div>

        <div class="summary-synopsis"><p>If the platform implements the IPv4 option <code class="inline">IP_PKTOPTIONS</code>, or the IPv6 option
<code class="inline">IPV6_PKTOPTIONS</code> or <code class="inline">IPV6_2292PKTOPTIONS</code> for the socket this value is returned
from <a href="inet.html#getopts/2"><code class="inline">inet:getopts/2</code></a> when called with the option name
<a href="#t:option_name/0"><code class="inline">pktoptions</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:socket/0" translate="no">socket()</a>

      </div>

        <div class="summary-synopsis"><p>As returned by <a href="#accept/1"><code class="inline">accept/1,2</code></a> and <a href="#connect/3"><code class="inline">connect/3,4</code></a>.</p></div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#accept/1" translate="no">accept(ListenSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#accept/2"><code class="inline">accept/2</code></a></p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#accept/2" translate="no">accept(ListenSocket, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Accepts an incoming connection request on a listening socket. <code class="inline">Socket</code> must be a
socket returned from <a href="#listen/2"><code class="inline">listen/2</code></a>. <code class="inline">Timeout</code> specifies a time-out value in
milliseconds. Defaults to <code class="inline">infinity</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#close/1" translate="no">close(Socket)</a>

      </div>

        <div class="summary-synopsis"><p>Closes a TCP socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/2" translate="no">connect(SockAddr, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#connect/3"><code class="inline">connect/3</code></a></p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/3" translate="no">connect/3</a>

      </div>

        <div class="summary-synopsis"><p><a href=""></a> <a href=""></a></p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/4" translate="no">connect(Address, Port, Opts, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p><a href=""></a> <a href=""></a></p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#controlling_process/2" translate="no">controlling_process(Socket, Pid)</a>

      </div>

        <div class="summary-synopsis"><p>Assigns a new controlling process <code class="inline">Pid</code> to <code class="inline">Socket</code>. The controlling process is
the process that receives messages from the socket. If called by any other
process than the current controlling process, <code class="inline">{error, not_owner}</code> is returned.
If the process identified by <code class="inline">Pid</code> is not an existing local pid,
<code class="inline">{error, badarg}</code> is returned. <code class="inline">{error, badarg}</code> may also be returned in some
cases when <code class="inline">Socket</code> is closed during the execution of this function.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#listen/2" translate="no">listen(Port, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Sets up a socket to listen on port <code class="inline">Port</code> on the local host.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#recv/2" translate="no">recv(Socket, Length)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#recv/3"><code class="inline">recv/3</code></a></p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#recv/3" translate="no">recv(Socket, Length, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Receives a packet from a socket in <em>passive</em> mode. A closed socket is indicated
by return value <code class="inline">{error, closed}</code>. If the socket is not in passive mode, the
return value is <code class="inline">{error, einval}</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#send/2" translate="no">send(Socket, Packet)</a>

      </div>

        <div class="summary-synopsis"><p>Sends a packet on a socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#shutdown/2" translate="no">shutdown(Socket, How)</a>

      </div>

        <div class="summary-synopsis"><p>Closes a socket in one or two directions.</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:connect_option/0">

  <div class="detail-header">
    <a href="#t:connect_option/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">connect_option()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L363" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> connect_option() ::
    {fd, Fd :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    <a href="inet.html#t:address_family/0">inet:address_family</a>() |
    {ifaddr, <a href="socket.html#t:sockaddr_in/0">socket:sockaddr_in</a>() | <a href="socket.html#t:sockaddr_in6/0">socket:sockaddr_in6</a>() | <a href="inet.html#t:socket_address/0">inet:socket_address</a>()} |
    {ip, <a href="inet.html#t:socket_address/0">inet:socket_address</a>()} |
    {port, <a href="inet.html#t:port_number/0">inet:port_number</a>()} |
    {tcp_module, <a href="../../apps/erts/erlang.html#t:module/0">module</a>()} |
    {netns, <a href="file.html#t:filename_all/0">file:filename_all</a>()} |
    {bind_to_device, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
    <a href="#t:option/0">option</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:listen_option/0">

  <div class="detail-header">
    <a href="#t:listen_option/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">listen_option()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L374" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> listen_option() ::
    {fd, Fd :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    <a href="inet.html#t:address_family/0">inet:address_family</a>() |
    {ifaddr, <a href="socket.html#t:sockaddr_in/0">socket:sockaddr_in</a>() | <a href="socket.html#t:sockaddr_in6/0">socket:sockaddr_in6</a>() | <a href="inet.html#t:socket_address/0">inet:socket_address</a>()} |
    {ip, <a href="inet.html#t:socket_address/0">inet:socket_address</a>()} |
    {port, <a href="inet.html#t:port_number/0">inet:port_number</a>()} |
    {backlog, B :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {tcp_module, <a href="../../apps/erts/erlang.html#t:module/0">module</a>()} |
    {netns, <a href="file.html#t:filename_all/0">file:filename_all</a>()} |
    {bind_to_device, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
    <a href="#t:option/0">option</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:option/0">

  <div class="detail-header">
    <a href="#t:option/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">option()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L262" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> option() ::
    {active, true | false | once | -32768..32767} |
    {buffer, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {debug, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {delay_send, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {deliver, port | term} |
    {dontroute, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {exit_on_close, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {exclusiveaddruse, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {header, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {high_msgq_watermark, <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()} |
    {high_watermark, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {keepalive, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {linger, {<a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>(), <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()}} |
    {low_msgq_watermark, <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()} |
    {low_watermark, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {mode, list | binary} |
    list | binary |
    {nodelay, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {packet,
     0 | 1 | 2 | 4 | raw | sunrm | asn1 | cdr | fcgi | line | tpkt | http | httph | http_bin |
     httph_bin} |
    {packet_size, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {priority, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {raw, Protocol :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(), OptionNum :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(), ValueBin :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
    {recbuf, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {reuseaddr, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {reuseport, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {reuseport_lb, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {send_timeout, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>() | infinity} |
    {send_timeout_close, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {show_econnreset, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {sndbuf, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {tos, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {tclass, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {ttl, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
    {recvtos, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {recvtclass, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {recvttl, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
    {ipv6_v6only, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:option_name/0">

  <div class="detail-header">
    <a href="#t:option_name/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">option_name()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L321" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> option_name() ::
    active | buffer | debug | delay_send | deliver | dontroute | exit_on_close |
    exclusiveaddruse | header | high_msgq_watermark | high_watermark | keepalive | linger |
    low_msgq_watermark | low_watermark | mode | nodelay | packet | packet_size | priority |
    {raw,
     Protocol :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
     OptionNum :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
     ValueSpec :: (ValueSize :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()) | (ValueBin :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>())} |
    recbuf | reuseaddr | reuseport | reuseport_lb | send_timeout | send_timeout_close |
    show_econnreset | sndbuf | tos | tclass | ttl | recvtos | recvtclass | recvttl | pktoptions |
    ipv6_v6only.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:pktoptions_value/0">

  <div class="detail-header">
    <a href="#t:pktoptions_value/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">pktoptions_value()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L319" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> pktoptions_value() :: {pktoptions, <a href="inet.html#t:ancillary_data/0">inet:ancillary_data</a>()}.</pre>

      </div>

<p>If the platform implements the IPv4 option <code class="inline">IP_PKTOPTIONS</code>, or the IPv6 option
<code class="inline">IPV6_PKTOPTIONS</code> or <code class="inline">IPV6_2292PKTOPTIONS</code> for the socket this value is returned
from <a href="inet.html#getopts/2"><code class="inline">inet:getopts/2</code></a> when called with the option name
<a href="#t:option_name/0"><code class="inline">pktoptions</code></a>.</p><blockquote><h4 class="info">Note</h4><p>This option appears to be VERY Linux specific, and its existence in future
Linux kernel versions is also worrying since the option is part of RFC 2292
which is since long (2003) obsoleted by RFC 3542 that <em>explicitly</em> removes
this possibility to get packet information from a stream socket. For
comparison: it has existed in FreeBSD but is now removed, at least since
FreeBSD 10.</p></blockquote>
  </section>
</section>
<section class="detail" id="t:socket/0">

  <div class="detail-header">
    <a href="#t:socket/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">socket()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L391" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> socket() :: <a href="inet.html#t:socket/0">inet:socket</a>().</pre>

      </div>

<p>As returned by <a href="#accept/1"><code class="inline">accept/1,2</code></a> and <a href="#connect/3"><code class="inline">connect/3,4</code></a>.</p><p><a href="" id="connect"></a></p>
  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="accept/1">

  <div class="detail-header">
    <a href="#accept/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">accept(ListenSocket)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L714" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> accept(ListenSocket) -> {ok, Socket} | {error, Reason}
          when
              ListenSocket :: <a href="#t:socket/0">socket</a>(),
              Socket :: <a href="#t:socket/0">socket</a>(),
              Reason :: closed | system_limit | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Equivalent to <a href="#accept/2"><code class="inline">accept/2</code></a></p>
  </section>
</section>
<section class="detail" id="accept/2">

  <div class="detail-header">
    <a href="#accept/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">accept(ListenSocket, Timeout)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L761" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> accept(ListenSocket, Timeout) -> {ok, Socket} | {error, Reason}
          when
              ListenSocket :: <a href="#t:socket/0">socket</a>(),
              Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
              Socket :: <a href="#t:socket/0">socket</a>(),
              Reason :: closed | timeout | system_limit | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Accepts an incoming connection request on a listening socket. <code class="inline">Socket</code> must be a
socket returned from <a href="#listen/2"><code class="inline">listen/2</code></a>. <code class="inline">Timeout</code> specifies a time-out value in
milliseconds. Defaults to <code class="inline">infinity</code>.</p><p>Returns:</p><ul><li><code class="inline">{ok, Socket}</code> if a connection is established</li><li><code class="inline">{error, closed}</code> if <code class="inline">ListenSocket</code> is closed</li><li><code class="inline">{error, timeout}</code> if no connection is established within the specified time</li><li><code class="inline">{error, system_limit}</code> if all available ports in the Erlang emulator are in
use</li><li>A POSIX error value if something else goes wrong, see <a href="inet.html"><code class="inline">inet</code></a> for possible
error values</li></ul><p>Packets can be sent to the returned socket <code class="inline">Socket</code> using <a href="#send/2"><code class="inline">send/2</code></a>. Packets sent
from the peer are delivered as messages (unless <code class="inline">{active, false}</code> is specified
in the option list for the listening socket, in which case packets are retrieved
by calling <a href="#recv/2"><code class="inline">recv/2</code></a>):</p><pre><code class="text">{tcp, Socket, Data}</code></pre><blockquote><h4 class="info">Note</h4><p>The <code class="inline">accept</code> call does <em>not</em> have to be issued from the socket owner process.
Using version 5.5.3 and higher of the emulator, multiple simultaneous accept
calls can be issued from different processes, which allows for a pool of
acceptor processes handling incoming connections.</p></blockquote>
  </section>
</section>
<section class="detail" id="close/1">

  <div class="detail-header">
    <a href="#close/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">close(Socket)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L844" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> close(Socket) -> ok when Socket :: <a href="#t:socket/0">socket</a>().</pre>

      </div>

<p>Closes a TCP socket.</p><p>Note that in most implementations of TCP, doing a <code class="inline">close</code> does not guarantee
that any data sent is delivered to the recipient before the close is detected at
the remote side. If you want to guarantee delivery of the data to the recipient
there are two common ways to achieve this.</p><ol><li>Use <a href="#shutdown/2"><code class="inline">gen_tcp:shutdown(Sock, write)</code></a> to signal that no more
data is to be sent and wait for the read side of the socket to be closed.</li><li>Use the socket option <a href="inet.html#packet"><code class="inline">{packet, N}</code></a> (or something similar)
to make it possible for the receiver to close the connection when it knowns
it has received all the data.</li></ol>
  </section>
</section>
<section class="detail" id="connect/2">

  <div class="detail-header">
    <a href="#connect/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">connect(SockAddr, Opts)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L412" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 24.3)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(SockAddr, Opts) -> {ok, Socket} | {error, Reason}
           when
               SockAddr :: <a href="socket.html#t:sockaddr_in/0">socket:sockaddr_in</a>() | <a href="socket.html#t:sockaddr_in6/0">socket:sockaddr_in6</a>(),
               Opts :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:connect_option/0">connect_option</a>()],
               Socket :: <a href="#t:socket/0">socket</a>(),
               Reason :: <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Equivalent to <a href="#connect/3"><code class="inline">connect/3</code></a></p>
  </section>
</section>
<section class="detail" id="connect/3">

  <div class="detail-header">
    <a href="#connect/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">connect/3</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L453" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP 24.3)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(Address, Port, Opts) -> {ok, Socket} | {error, Reason}
           when
               Address :: <a href="inet.html#t:socket_address/0">inet:socket_address</a>() | <a href="inet.html#t:hostname/0">inet:hostname</a>(),
               Port :: <a href="inet.html#t:port_number/0">inet:port_number</a>(),
               Opts :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:connect_option/0">connect_option</a>()],
               Socket :: <a href="#t:socket/0">socket</a>(),
               Reason :: <a href="inet.html#t:posix/0">inet:posix</a>();
       (SockAddr, Opts, Timeout) -> {ok, Socket} | {error, Reason}
           when
               SockAddr :: <a href="socket.html#t:sockaddr_in/0">socket:sockaddr_in</a>() | <a href="socket.html#t:sockaddr_in6/0">socket:sockaddr_in6</a>(),
               Opts :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:connect_option/0">connect_option</a>()],
               Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
               Socket :: <a href="#t:socket/0">socket</a>(),
               Reason :: timeout | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p><a href="" id="connect-sockaddr2"></a> <a href="" id="connect-sockaddr3"></a></p><p>Connects to a server according to <code class="inline">SockAddr</code>. This is primarily intended for
link local IPv6 addresses (which require the scope-id),
<a href="socket.html#t:sockaddr_in6/0"><code class="inline">socket:sockaddr_in6/0</code></a>. But for completeness, we also support IPv4,
<a href="socket.html#t:sockaddr_in/0"><code class="inline">socket:sockaddr_in/0</code></a>.</p><p>The <a href="gen_tcp.html#connect-options"><code class="inline">options</code></a> available are the same as for
<a href="gen_tcp.html#connect-port3"><code class="inline">connect/3,4</code></a>.</p><blockquote><h4 class="info">Note</h4><p>Keep in mind that if the underlying OS <code class="inline">connect()</code> call returns a timeout,
<code class="inline">gen_tcp:connect</code> will also return a timeout (i.e. <code class="inline">{error, etimedout}</code>), even
if a larger <code class="inline">Timeout</code> was specified.</p></blockquote><blockquote><h4 class="info">Note</h4><p>The default values for options specified to <code class="inline">connect</code> can be affected by the
Kernel configuration parameter <code class="inline">inet_default_connect_options</code>. For details,
see <a href="inet.html"><code class="inline">inet</code></a>.</p></blockquote>
  </section>
</section>
<section class="detail" id="connect/4">

  <div class="detail-header">
    <a href="#connect/4" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">connect(Address, Port, Opts, Timeout)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L578" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(Address, Port, Opts, Timeout) -> {ok, Socket} | {error, Reason}
           when
               Address :: <a href="inet.html#t:socket_address/0">inet:socket_address</a>() | <a href="inet.html#t:hostname/0">inet:hostname</a>(),
               Port :: <a href="inet.html#t:port_number/0">inet:port_number</a>(),
               Opts :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:connect_option/0">connect_option</a>()],
               Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
               Socket :: <a href="#t:socket/0">socket</a>(),
               Reason :: timeout | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p><a href="" id="connect-port3"></a> <a href="" id="connect-port4"></a></p><p>Connects to a server on TCP port <code class="inline">Port</code> on the host with IP address <code class="inline">Address</code>.
Argument <code class="inline">Address</code> can be a hostname or an IP address.</p><p><a href="" id="connect-options"></a></p><p>The following options are available:</p><ul><li><p><strong><code class="inline">{ip, Address}</code></strong> - If the host has many network interfaces, this option
specifies which one to use.</p></li><li><p><strong><code class="inline">{ifaddr, Address}</code></strong> - Same as <code class="inline">{ip, Address}</code>. If the host has many
network interfaces, this option specifies which one to use.</p><p>However, if this instead is an <a href="socket.html#t:sockaddr_in/0"><code class="inline">socket:sockaddr_in/0</code></a> or
<a href="socket.html#t:sockaddr_in6/0"><code class="inline">socket:sockaddr_in6/0</code></a> this takes precedence over any value previously set
with the <code class="inline">ip</code> and <code class="inline">port</code> options. If these options (<code class="inline">ip</code> or/and <code class="inline">port</code>)
however comes <em>after</em> this option, they may be used to <em>update</em> their
corresponding fields of this options (for <code class="inline">ip</code>, the <code class="inline">addr</code> field, and for
<code class="inline">port</code>, the <code class="inline">port</code> field).</p></li><li><p><strong><code class="inline">{fd, integer() &gt;= 0}</code></strong> - If a socket has somehow been connected without
using <code class="inline">gen_tcp</code>, use this option to pass the file descriptor for it. If
<code class="inline">{ip, Address}</code> and/or <code class="inline">{port, port_number()}</code> is combined with this option,
the <code class="inline">fd</code> is bound to the specified interface and port before connecting. If
these options are not specified, it is assumed that the <code class="inline">fd</code> is already bound
appropriately.</p></li><li><p><strong><code class="inline">inet</code></strong> - Sets up the socket for IPv4.</p></li><li><p><strong><code class="inline">inet6</code></strong> - Sets up the socket for IPv6.</p></li><li><p><strong><code class="inline">local</code></strong> - Sets up a Unix Domain Socket. See <a href="inet.html#t:local_address/0"><code class="inline">inet:local_address/0</code></a></p></li><li><p><strong><code class="inline">{port, Port}</code></strong> - Specifies which local port number to use.</p></li><li><p><strong><code class="inline">{tcp_module, module()}</code></strong> - Overrides which callback module is used.
Defaults to <code class="inline">inet_tcp</code> for IPv4 and <code class="inline">inet6_tcp</code> for IPv6.</p></li><li><p><strong><code class="inline">Opt</code></strong> - See <a href="inet.html#setopts/2"><code class="inline">inet:setopts/2</code></a>.</p></li></ul><p>Packets can be sent to the returned socket <code class="inline">Socket</code> using <a href="#send/2"><code class="inline">send/2</code></a>. Packets sent
from the peer are delivered as messages:</p><pre><code class="text">{tcp, Socket, Data}</code></pre><p>If the socket is in <code class="inline">{active, N}</code> mode (see <a href="inet.html#setopts/2"><code class="inline">inet:setopts/2</code></a> for details) and
its message counter drops to <code class="inline">0</code>, the following message is delivered to indicate
that the socket has transitioned to passive (<code class="inline">{active, false}</code>) mode:</p><pre><code class="text">{tcp_passive, Socket}</code></pre><p>If the socket is closed, the following message is delivered:</p><pre><code class="text">{tcp_closed, Socket}</code></pre><p>If an error occurs on the socket, the following message is delivered (unless
<code class="inline">{active, false}</code> is specified in the option list for the socket, in which case
packets are retrieved by calling <a href="#recv/2"><code class="inline">recv/2</code></a>):</p><pre><code class="text">{tcp_error, Socket, Reason}</code></pre><p>The optional <code class="inline">Timeout</code> parameter specifies a time-out in milliseconds. Defaults
to <code class="inline">infinity</code>.</p><blockquote><h4 class="info">Note</h4><p>Keep in mind that if the underlying OS <code class="inline">connect()</code> call returns a timeout,
<code class="inline">gen_tcp:connect</code> will also return a timeout (i.e. <code class="inline">{error, etimedout}</code>), even
if a larger <code class="inline">Timeout</code> was specified.</p></blockquote><blockquote><h4 class="info">Note</h4><p>The default values for options specified to <code class="inline">connect</code> can be affected by the
Kernel configuration parameter <code class="inline">inet_default_connect_options</code>. For details,
see <a href="inet.html"><code class="inline">inet</code></a>.</p></blockquote>
  </section>
</section>
<section class="detail" id="controlling_process/2">

  <div class="detail-header">
    <a href="#controlling_process/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">controlling_process(Socket, Pid)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L996" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> controlling_process(Socket, Pid) -> ok | {error, Reason}
                       when
                           Socket :: <a href="#t:socket/0">socket</a>(),
                           Pid :: <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(),
                           Reason :: closed | not_owner | badarg | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Assigns a new controlling process <code class="inline">Pid</code> to <code class="inline">Socket</code>. The controlling process is
the process that receives messages from the socket. If called by any other
process than the current controlling process, <code class="inline">{error, not_owner}</code> is returned.
If the process identified by <code class="inline">Pid</code> is not an existing local pid,
<code class="inline">{error, badarg}</code> is returned. <code class="inline">{error, badarg}</code> may also be returned in some
cases when <code class="inline">Socket</code> is closed during the execution of this function.</p><p>If the socket is set in active mode, this function will transfer any messages in
the mailbox of the caller to the new controlling process. If any other process
is interacting with the socket while the transfer is happening, the transfer may
not work correctly and messages may remain in the caller's mailbox. For instance
changing the sockets active mode before the transfer is complete may cause this.</p>
  </section>
</section>
<section class="detail" id="listen/2">

  <div class="detail-header">
    <a href="#listen/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">listen(Port, Options)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L684" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> listen(Port, Options) -> {ok, ListenSocket} | {error, Reason}
          when
              Port :: <a href="inet.html#t:port_number/0">inet:port_number</a>(),
              Options :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:listen_option/0">listen_option</a>()],
              ListenSocket :: <a href="#t:socket/0">socket</a>(),
              Reason :: system_limit | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Sets up a socket to listen on port <code class="inline">Port</code> on the local host.</p><p>If <code class="inline">Port == 0</code>, the underlying OS assigns an available port number, use
<a href="inet.html#port/1"><code class="inline">inet:port/1</code></a> to retrieve it.</p><p>The following options are available:</p><ul><li><p><strong><code class="inline">list</code></strong> - Received <code class="inline">Packet</code> is delivered as a list.</p></li><li><p><strong><code class="inline">binary</code></strong> - Received <code class="inline">Packet</code> is delivered as a binary.</p></li><li><p><strong><code class="inline">{backlog, B}</code></strong> - <code class="inline">B</code> is an integer &gt;= <code class="inline">0</code>. The backlog value defines the
maximum length that the queue of pending connections can grow to. Defaults to
<code class="inline">5</code>.</p></li><li><p><strong><code class="inline">inet6</code></strong> - Sets up the socket for IPv6.</p></li><li><p><strong><code class="inline">inet</code></strong> - Sets up the socket for IPv4.</p></li><li><p><strong><code class="inline">{fd, Fd}</code></strong> - If a socket has somehow been connected without using
<code class="inline">gen_tcp</code>, use this option to pass the file descriptor for it.</p></li><li><p><strong><code class="inline">{ip, Address}</code></strong> - If the host has many network interfaces, this option
specifies which one to listen on.</p></li><li><p><strong><code class="inline">{port, Port}</code></strong> - Specifies which local port number to use.</p></li><li><p><strong><code class="inline">{ifaddr, Address}</code></strong> - Same as <code class="inline">{ip, Address}</code>. If the host has many
network interfaces, this option specifies which one to use.</p><p>However, if this instead is an <a href="socket.html#t:sockaddr_in/0"><code class="inline">socket:sockaddr_in/0</code></a> or
<a href="socket.html#t:sockaddr_in6/0"><code class="inline">socket:sockaddr_in6/0</code></a> this takes precedence over any value previously set
with the <code class="inline">ip</code> and <code class="inline">port</code> options. If these options (<code class="inline">ip</code> or/and <code class="inline">port</code>)
however comes <em>after</em> this option, they may be used to <em>update</em> their
corresponding fields of this options (for <code class="inline">ip</code>, the <code class="inline">addr</code> field, and for
<code class="inline">port</code>, the <code class="inline">port</code> field).</p></li><li><p><strong><code class="inline">{tcp_module, module()}</code></strong> - Overrides which callback module is used.
Defaults to <code class="inline">inet_tcp</code> for IPv4 and <code class="inline">inet6_tcp</code> for IPv6.</p></li><li><p><strong><code class="inline">Opt</code></strong> - See <a href="inet.html#setopts/2"><code class="inline">inet:setopts/2</code></a>.</p></li></ul><p>The returned socket <code class="inline">ListenSocket</code> should be used in calls to
<a href="#accept/1"><code class="inline">accept/1,2</code></a> to accept incoming connection requests.</p><blockquote><h4 class="info">Note</h4><p>The default values for options specified to <code class="inline">listen</code> can be affected by the
Kernel configuration parameter <code class="inline">inet_default_listen_options</code>. For details, see
<a href="inet.html"><code class="inline">inet</code></a>.</p></blockquote>
  </section>
</section>
<section class="detail" id="recv/2">

  <div class="detail-header">
    <a href="#recv/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">recv(Socket, Length)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L914" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> recv(Socket, Length) -> {ok, Packet} | {error, Reason}
        when
            Socket :: <a href="#t:socket/0">socket</a>(),
            Length :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
            Packet :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>() | <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | HttpPacket,
            Reason :: closed | <a href="inet.html#t:posix/0">inet:posix</a>(),
            HttpPacket :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Equivalent to <a href="#recv/3"><code class="inline">recv/3</code></a></p>
  </section>
</section>
<section class="detail" id="recv/3">

  <div class="detail-header">
    <a href="#recv/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">recv(Socket, Length, Timeout)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L952" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> recv(Socket, Length, Timeout) -> {ok, Packet} | {error, Reason}
        when
            Socket :: <a href="#t:socket/0">socket</a>(),
            Length :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
            Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
            Packet :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>() | <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | HttpPacket,
            Reason :: closed | timeout | <a href="inet.html#t:posix/0">inet:posix</a>(),
            HttpPacket :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Receives a packet from a socket in <em>passive</em> mode. A closed socket is indicated
by return value <code class="inline">{error, closed}</code>. If the socket is not in passive mode, the
return value is <code class="inline">{error, einval}</code>.</p><p>Argument <code class="inline">Length</code> is only meaningful when the socket is in <code class="inline">raw</code> mode and
denotes the number of bytes to read. If <code class="inline">Length</code> is <code class="inline">0</code>, all available bytes are
returned. If <code class="inline">Length</code> &gt; <code class="inline">0</code>, exactly <code class="inline">Length</code> bytes are returned, or an error;
possibly discarding less than <code class="inline">Length</code> bytes of data when the socket is closed
from the other side.</p><p>The optional <code class="inline">Timeout</code> parameter specifies a time-out in milliseconds. Defaults
to <code class="inline">infinity</code>.</p><p>Any process can receive data from a passive socket, even if that process is not
the controlling process of the socket. However, only one process can call this
function on a socket at any given time. Using simultaneous calls to <code class="inline">recv</code> is
not recommended as its behavior is dependent on the socket implementation, and
could return errors such as <code class="inline">{error, ealready}</code>.</p>
  </section>
</section>
<section class="detail" id="send/2">

  <div class="detail-header">
    <a href="#send/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">send(Socket, Packet)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L892" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> send(Socket, Packet) -> ok | {error, Reason}
        when
            Socket :: <a href="#t:socket/0">socket</a>(),
            Packet :: <a href="../../apps/erts/erlang.html#t:iodata/0">iodata</a>(),
            Reason :: closed | {timeout, RestData} | <a href="inet.html#t:posix/0">inet:posix</a>(),
            RestData :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>().</pre>

      </div>

<p>Sends a packet on a socket.</p><p>There is no <code class="inline">send</code> call with a time-out option, use socket option <code class="inline">send_timeout</code>
if time-outs are desired. See section <a href="gen_tcp.html#module-examples">Examples</a>.</p><p>The return value <code class="inline">{error, {timeout, RestData}}</code> can only be returned when
<code class="inline">inet_backend = socket</code>.</p><p><a href="" id="non_blocking_send"></a></p><blockquote><h4 class="info">Note</h4><p>Non-blocking send.</p><p>If the user tries to send more data than there is room for in the OS send
buffers, the 'rest data' is put into (inet driver) internal buffers and later
sent in the background. The function immediately returns ok (<em>not</em> informing
the caller that not all of the data was actually sent). Any issue while
sending the 'rest data' is maybe returned later.</p><p>When using <code class="inline">inet_backend = socket</code>, the behaviour is different. There is <em>no</em>
buffering done (like the inet-driver does), instead the caller will &quot;hang&quot;
until all of the data has been sent or send timeout (as specified by the
<code class="inline">send_timeout</code> option) expires (the function can hang even when using 'inet'
backend if the internal buffers are full).</p><p>If this happens when using <code class="inline">packet =/= raw</code>, we have a partial package
written. A new package therefore <em>must not</em> be written at this point, as there
is no way for the peer to distinguish this from the data portion of the
current package. Instead, set package to raw, send the rest data (as raw data)
and then set package to the wanted package type again.</p></blockquote>
  </section>
</section>
<section class="detail" id="shutdown/2">

  <div class="detail-header">
    <a href="#shutdown/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">shutdown(Socket, How)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/kernel/src/gen_tcp.erl#L813" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> shutdown(Socket, How) -> ok | {error, Reason}
            when Socket :: <a href="#t:socket/0">socket</a>(), How :: read | write | read_write, Reason :: <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Closes a socket in one or two directions.</p><p><code class="inline">How == write</code> means closing the socket for writing, reading from it is still
possible.</p><p>If <code class="inline">How == read</code> or there is no outgoing data buffered in the <code class="inline">Socket</code> port, the
socket is shut down immediately and any error encountered is returned in
<code class="inline">Reason</code>.</p><p>If there is data buffered in the socket port, the attempt to shutdown the socket
is postponed until that data is written to the kernel socket send buffer. If any
errors are encountered, the socket is closed and <code class="inline">{error, closed}</code> is returned
on the next <a href="#recv/2"><code class="inline">recv/2</code></a> or <a href="#send/2"><code class="inline">send/2</code></a>.</p><p>Option <code class="inline">{exit_on_close, false}</code> is useful if the peer has done a shutdown on the
write side.</p><p><a href="" id="async_shutdown_write"></a></p><blockquote><h4 class="info">Note</h4><p>Async shutdown write (write or read_write).</p><p>If the shutdown attempt is made while the inet-driver is sending buffered data
in the background, the shutdown is postponed until all buffered data has been
sent. The function immediately returns <code class="inline">ok</code> and the caller is <em>not</em> informed
(that the shutdown has <em>not yet</em> been performed).</p><p>When using <code class="inline">inet_backend = socket</code>, the behaviour is different. A shutdown
with <code class="inline">How == write | read_write</code>, the operation will take <em>immediate</em> effect
(unlike the inet-driver, which basically saves the operation for later).</p></blockquote>
  </section>
</section>

    </div>
  </section>

      <footer class="footer">
        <p>

          <span class="line">
            <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
              Search HexDocs
            </button>

              <a href="kernel.epub" title="ePub version">
                Download ePub version
              </a>

          </span>
        </p>

        <p class="built-using">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.31.1) for the

            <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

        </p>
      </footer>
    </div>
  </div>
</main>
</div>


  </body>
</html>
