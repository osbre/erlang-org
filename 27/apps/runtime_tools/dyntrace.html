<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.31.1">
    <meta name="project" content="runtime_tools v2.1">


    <title>dyntrace â€” runtime_tools v2.1</title>
    <link rel="stylesheet" href="dist/html-erlang-YUARVD4J.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-43PMFBC7.js"></script>
    <script src="dist/sidebar_items-6C3A61ED.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-L4O5OK2K.js"></script>

<style>.dark img { background-color: white; }</style>
  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<div class="background-layer"></div>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="runtime_tools" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
runtime_tools
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v2.1
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">
      <div class="top-search">
        <div class="search-settings">
          <form class="search-bar" action="search.html">
            <label class="search-label">
              <span class="sr-only">Search documentation of runtime_tools</span>
              <input name="q" type="text" class="search-input" placeholder="Search Documentation (press /)" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
            </label>
            <button type="submit" class="search-button" aria-label="Submit Search">
              <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
            </button>
            <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
              <i class="ri-close-line ri-lg" title="Cancel search"></i>
            </button>
          </form>
          <div class="autocomplete">
          </div>
          <button class="icon-settings display-settings">
            <i class="ri-settings-3-line"></i>
            <span class="sr-only">Settings</span>
          </button>
        </div>

      </div>

<h1>

    <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L21" title="View Source" class="icon-action" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span translate="no">dyntrace</span> 
  <small class="app-vsn" translate="no">(runtime_tools v2.1)</small>

</h1>


  <section id="moduledoc">
<p>Interface to dynamic tracing</p><p>This module implements interfaces to dynamic tracing, should such be compiled
into the virtual machine. For a standard and/or commercial build, no dynamic
tracing is available, in which case none of the functions in this module is
usable or give any effect.</p><p>Should dynamic tracing be enabled in the current build, either by configuring
with <code class="inline">./configure --with-dynamic-trace=dtrace</code> or with
<code class="inline">./configure --with-dynamic-trace=systemtap</code>, the module can be used for two
things:</p><ul><li>Trigger the user-probe <code class="inline">user_trace_i4s4</code> in the NIF library <code class="inline">dyntrace.so</code> by
calling <code class="inline">dyntrace:p/{1,2,3,4,5,6,7,8}</code>.</li><li>Set a user specified tag that will be present in the trace messages of both
the <code class="inline">efile_drv</code> and the user-probe mentioned above.</li></ul><p>Both building with dynamic trace probes and using them is experimental and
unsupported by Erlang/OTP. It is included as an option for the developer to
trace and debug performance issues in their systems.</p><p>The original implementation is mostly done by Scott Lystiger Fritchie as an Open
Source Contribution and it should be viewed as such even though the source for
dynamic tracing as well as this module is included in the main distribution.
However, the ability to use dynamic tracing of the virtual machine is a very
valuable contribution which OTP has every intention to maintain as a tool for
the developer.</p><p>How to write <code class="inline">d</code> programs or <code class="inline">systemtap</code> scripts can be learned from books and
from a lot of pages on the Internet. This manual page does not include any
documentation about using the dynamic trace tools of respective platform. The
<code class="inline">examples</code> directory of the <code class="inline">runtime_tools</code> application however contains
comprehensive examples of both <code class="inline">d</code> and <code class="inline">systemtap</code> programs that will help you
get started. Another source of information is the <a href="dtrace.html">dtrace</a> and
<a href="systemtap.html">systemtap</a> chapters in the Runtime Tools Users' Guide.</p>
  </section>


  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:probe_arg/0" translate="no">probe_arg()</a>

      </div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#available/0" translate="no">available()</a>

      </div>

        <div class="summary-synopsis"><p>available() -&gt; boolean()</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#get_tag/0" translate="no">get_tag()</a>

      </div>

        <div class="summary-synopsis"><p>get_tag() -&gt; binary() | undefined</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/0" translate="no">p()</a>

      </div>

        <div class="summary-synopsis"><p>p() -&gt; true | false | error | badarg</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/1" translate="no">p/1</a>

      </div>

        <div class="summary-synopsis"><p>p(integer() | string()) -&gt; true | false | error | badarg</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/2" translate="no">p/2</a>

      </div>

        <div class="summary-synopsis"><p>p(integer() | string(), integer() | string()) -&gt; true | false | error | badarg</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/3" translate="no">p/3</a>

      </div>

        <div class="summary-synopsis"><p>p(integer() | string(), integer() | string(), integer() | string()) -&gt; true |
false | error | badarg</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/4" translate="no">p/4</a>

      </div>

        <div class="summary-synopsis"><p>p(integer() | string(), integer() | string(), integer() | string(), integer() |
string()) -&gt; true | false | error | badarg</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/5" translate="no">p/5</a>

      </div>

        <div class="summary-synopsis"><table><tbody><tr><td style="text-align: left;">p(integer(), integer()</td><td style="text-align: left;">string(), integer()</td><td style="text-align: left;">string(), integer()</td><td style="text-align: left;">string(),</td></tr><tr><td style="text-align: left;">string()) -&gt; true</td><td style="text-align: left;">false</td><td style="text-align: left;">error</td><td style="text-align: left;">badarg</td></tr></tbody></table><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing the user tag and the
integer() or string() parameters as the first fields of respective type.
integer() parameters should be put before any string() parameters, as in <a href="#p/2"><code class="inline">p/2</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/6" translate="no">p/6</a>

      </div>

        <div class="summary-synopsis"><p>p(integer(), integer(), integer() | string(), integer() | string(), string(),
string()) -&gt; true | false | error | badarg</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/7" translate="no">p/7</a>

      </div>

        <div class="summary-synopsis"><p>p(integer(), integer(), integer(), integer() | string(), string(), string(),
string()) -&gt; true | false | error | badarg</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#p/8" translate="no">p(I1, I2, I3, I4, S1, S2, S3, S4)</a>

      </div>

        <div class="summary-synopsis"><p>p(integer(), integer(), integer(), integer(), string(), string(), string(),
string()) -&gt; true | false | error | badarg</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#put_tag/1" translate="no">put_tag(Data)</a>

      </div>

        <div class="summary-synopsis"><p>put_tag(Item) -&gt; binary() | undefined</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#restore_tag/1" translate="no">restore_tag(T)</a>

      </div>

        <div class="summary-synopsis"><p>restore_tag(TagData) -&gt; true</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#spread_tag/1" translate="no">spread_tag(B)</a>

      </div>

        <div class="summary-synopsis"><p>spread_tag(boolean()) -&gt; TagData</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:probe_arg/0">

  <div class="detail-header">
    <a href="#t:probe_arg/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">probe_arg()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L138" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(not exported)</span>

      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> probe_arg() :: <a href="../../apps/erts/erlang.html#t:integer/0">integer</a>() | <a href="../../apps/erts/erlang.html#t:iolist/0">iolist</a>().</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="available/0">

  <div class="detail-header">
    <a href="#available/0" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">available()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L205" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> available() -> true | false.</pre>

      </div>

<p>available() -&gt; boolean()</p><p>This function uses the NIF library to determine if dynamic tracing is available.
Usually calling <a href="../../apps/erts/erlang.html#system_info/1"><code class="inline">erlang:system_info/1</code></a> is a better indicator of the availability
of dynamic tracing.</p><p>The function will throw an exception if the <code class="inline">dyntrace</code> NIF library could not be
loaded by the on_load function of this module.</p>
  </section>
</section>
<section class="detail" id="get_tag/0">

  <div class="detail-header">
    <a href="#get_tag/0" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_tag()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L649" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> get_tag() -> <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | undefined.</pre>

      </div>

<p>get_tag() -&gt; binary() | undefined</p><p>This function returns the user tag set in the current process. If no tag is set
or dynamic tracing is not available, it returns <code class="inline">undefined</code></p><p>This function returns the user tag set in the current process or, if no user tag
is present, the last user tag sent to the process together with a message (in
the same way as <a href="../../apps/kernel/seq_trace.html">sequential trace tokens</a> are spread to other
processes together with messages. For an explanation of how user tags can be
spread together with messages, see <a href="#spread_tag/1"><code class="inline">spread_tag/1</code></a>. If no tag is found or dynamic
tracing is not available, it returns <code class="inline">undefined</code></p>
  </section>
</section>
<section class="detail" id="p/0">

  <div class="detail-header">
    <a href="#p/0" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p()</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L321" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p() -> true | false | error | badarg.</pre>

      </div>

<p>p() -&gt; true | false | error | badarg</p><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message only containing the user tag and
zeroes/empty strings in all other fields.</p>
  </section>
</section>
<section class="detail" id="p/1">

  <div class="detail-header">
    <a href="#p/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p/1</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L334" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p(<a href="#t:probe_arg/0">probe_arg</a>()) -> true | false | error | badarg.</pre>

      </div>

<p>p(integer() | string()) -&gt; true | false | error | badarg</p><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing the user tag and the
integer or string parameter in the first integer/string field.</p>
  </section>
</section>
<section class="detail" id="p/2">

  <div class="detail-header">
    <a href="#p/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p/2</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L352" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p(<a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>()) -> true | false | error | badarg.</pre>

      </div>

<p>p(integer() | string(), integer() | string()) -&gt; true | false | error | badarg</p><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing the user tag and the
integer() or string() parameters as the first fields of respective type.
integer() parameters should be put before any string() parameters. I.e.
<a href="#p/2"><code class="inline">p(1,&quot;Hello&quot;)</code></a> is ok, as is <a href="#p/2"><code class="inline">p(1,1)</code></a> and
<a href="#p/2"><code class="inline">p(&quot;Hello&quot;,&quot;Again&quot;)</code></a>, but not <a href="#p/2"><code class="inline">p(&quot;Hello&quot;,1)</code></a>.</p>
  </section>
</section>
<section class="detail" id="p/3">

  <div class="detail-header">
    <a href="#p/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p/3</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L371" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p(<a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>()) -> true | false | error | badarg.</pre>

      </div>

<p>p(integer() | string(), integer() | string(), integer() | string()) -&gt; true |
false | error | badarg</p><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing the user tag and the
integer() or string() parameters as the first fields of respective type.
integer() parameters should be put before any string() parameters, as in <a href="#p/2"><code class="inline">p/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="p/4">

  <div class="detail-header">
    <a href="#p/4" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p/4</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L393" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p(<a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>()) -> true | false | error | badarg.</pre>

      </div>

<p>p(integer() | string(), integer() | string(), integer() | string(), integer() |
string()) -&gt; true | false | error | badarg</p><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing the user tag and the
integer() or string() parameters as the first fields of respective type.
integer() parameters should be put before any string() parameters, as in <a href="#p/2"><code class="inline">p/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="p/5">

  <div class="detail-header">
    <a href="#p/5" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p/5</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L421" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p(<a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>()) ->
     true | false | error | badarg.</pre>

      </div>

<table><tbody><tr><td style="text-align: left;">p(integer(), integer()</td><td style="text-align: left;">string(), integer()</td><td style="text-align: left;">string(), integer()</td><td style="text-align: left;">string(),</td></tr><tr><td style="text-align: left;">string()) -&gt; true</td><td style="text-align: left;">false</td><td style="text-align: left;">error</td><td style="text-align: left;">badarg</td></tr></tbody></table><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing the user tag and the
integer() or string() parameters as the first fields of respective type.
integer() parameters should be put before any string() parameters, as in <a href="#p/2"><code class="inline">p/2</code></a>.</p><p>There can be no more than four parameters of any type (integer() or string()),
so the first parameter has to be an integer() and the last a string().</p>
  </section>
</section>
<section class="detail" id="p/6">

  <div class="detail-header">
    <a href="#p/6" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p/6</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L447" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p(<a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>()) ->
     true | false | error | badarg.</pre>

      </div>

<p>p(integer(), integer(), integer() | string(), integer() | string(), string(),
string()) -&gt; true | false | error | badarg</p><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing the user tag and the
integer() or string() parameters as the first fields of respective type.
integer() parameters should be put before any string() parameters, as in <a href="#p/2"><code class="inline">p/2</code></a>.</p><p>There can be no more than four parameters of any type (integer() or string()),
so the first two parameters has to be integer()'s and the last two string()'s.</p>
  </section>
</section>
<section class="detail" id="p/7">

  <div class="detail-header">
    <a href="#p/7" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p/7</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L472" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p(<a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>(), <a href="#t:probe_arg/0">probe_arg</a>()) ->
     true | false | error | badarg.</pre>

      </div>

<p>p(integer(), integer(), integer(), integer() | string(), string(), string(),
string()) -&gt; true | false | error | badarg</p><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing the user tag and the
integer() or string() parameters as the first fields of respective type.
integer() parameters should be put before any string() parameters, as in <a href="#p/2"><code class="inline">p/2</code></a>.</p><p>There can be no more than four parameters of any type (integer() or string()),
so the first three parameters has to be integer()'s and the last three
string()'s.</p>
  </section>
</section>
<section class="detail" id="p/8">

  <div class="detail-header">
    <a href="#p/8" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">p(I1, I2, I3, I4, S1, S2, S3, S4)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L490" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> p(<a href="#t:probe_arg/0">probe_arg</a>(),
  <a href="#t:probe_arg/0">probe_arg</a>(),
  <a href="#t:probe_arg/0">probe_arg</a>(),
  <a href="#t:probe_arg/0">probe_arg</a>(),
  <a href="#t:probe_arg/0">probe_arg</a>(),
  <a href="#t:probe_arg/0">probe_arg</a>(),
  <a href="#t:probe_arg/0">probe_arg</a>(),
  <a href="#t:probe_arg/0">probe_arg</a>()) ->
     true | false | error | badarg.</pre>

      </div>

<p>p(integer(), integer(), integer(), integer(), string(), string(), string(),
string()) -&gt; true | false | error | badarg</p><p>Calling this function will trigger the &quot;user&quot; trace probe user_trace_i4s4 in the
dyntrace NIF module, sending a trace message containing all the integer()'s and
string()'s provided, as well as any user tag set in the current process.</p>
  </section>
</section>
<section class="detail" id="put_tag/1">

  <div class="detail-header">
    <a href="#put_tag/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">put_tag(Data)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L631" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> put_tag(undefined | <a href="../../apps/erts/erlang.html#t:iodata/0">iodata</a>()) -> <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | undefined.</pre>

      </div>

<p>put_tag(Item) -&gt; binary() | undefined</p><p>This function sets the user tag of the current process. The user tag is a
binary(), but can be specified as any iodata(), which is automatically converted
to a binary by this function.</p><p>The user tag is provided to the user probes triggered by calls top
<code class="inline">dyntrace:p/{1,2,3,4,5,6,7,8}</code> as well as probes in the efile_driver. In the
future, user tags might be added to more probes.</p><p>The old user tag (if any) is returned, or <code class="inline">undefined</code> if no user tag was present
or dynamic tracing is not enabled.</p>
  </section>
</section>
<section class="detail" id="restore_tag/1">

  <div class="detail-header">
    <a href="#restore_tag/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">restore_tag(T)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L728" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> restore_tag(true | {<a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(), <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | []}) -> true.</pre>

      </div>

<p>restore_tag(TagData) -&gt; true</p><p>Restores the previous state of user tags and their spreading as it was before a
call to <a href="#spread_tag/1"><code class="inline">spread_tag/1</code></a>. Note that the restoring is not limited to the same
process, one can utilize this to turn off spreding in one process and restore it
in a newly created, the one that actually is going to send messages:</p><pre><code class="makeup erlang" translate="no"><span class="nf">f</span><span class="p" data-group-id="0220725110-1">(</span><span class="p" data-group-id="0220725110-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">TagData</span><span class="o">=</span><span class="nc">dyntrace</span><span class="p">:</span><span class="nf">spread_tag</span><span class="p" data-group-id="0220725110-2">(</span><span class="ss">false</span><span class="p" data-group-id="0220725110-2">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">spawn</span><span class="p" data-group-id="0220725110-3">(</span><span class="nf">fun</span><span class="p" data-group-id="0220725110-4">(</span><span class="p" data-group-id="0220725110-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
             </span><span class="nc">dyntrace</span><span class="p">:</span><span class="nf">restore_tag</span><span class="p" data-group-id="0220725110-5">(</span><span class="n">TagData</span><span class="p" data-group-id="0220725110-5">)</span><span class="p">,</span><span class="w">
             </span><span class="nf">do_something</span><span class="p" data-group-id="0220725110-6">(</span><span class="p" data-group-id="0220725110-6">)</span><span class="w">
          </span><span class="k">end</span><span class="p" data-group-id="0220725110-3">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">do_something_else</span><span class="p" data-group-id="0220725110-7">(</span><span class="p" data-group-id="0220725110-7">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">dyntrace</span><span class="p">:</span><span class="nf">restore_tag</span><span class="p" data-group-id="0220725110-8">(</span><span class="n">TagData</span><span class="p" data-group-id="0220725110-8">)</span><span class="p">.</span></code></pre><p>Correctly handling user tags and their spreading might take some effort, as
Erlang programs tend to send and receive messages so that sometimes the user tag
gets lost due to various things, like double receives or communication with a
port (ports do not handle user tags, in the same way as they do not handle
regular sequential trace tokens).</p>
  </section>
</section>
<section class="detail" id="spread_tag/1">

  <div class="detail-header">
    <a href="#spread_tag/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">spread_tag(B)</h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/dyntrace.erl#L698" class="icon-action" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


      <span class="note">(since OTP R15B01)</span>

  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> spread_tag(<a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()) -> true | {<a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(), <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | []}.</pre>

      </div>

<p>spread_tag(boolean()) -&gt; TagData</p><p>This function controls if user tags are to be spread to other processes with the
next message. Spreading of user tags work like spreading of sequential trace
tokens, so that a received user tag will be active in the process until the next
message arrives (if that message does not also contain the user tag.</p><p>This functionality is used when a client process communicates with a file
i/o-server to spread the user tag to the I/O-server and then down to the
efile_drv driver. By using <a href="#spread_tag/1"><code class="inline">spread_tag/1</code></a> and
<a href="#restore_tag/1"><code class="inline">restore_tag/1</code></a>, one can enable or disable spreading of user
tags to other processes and then restore the previous state of the user tag. The
TagData returned from this call contains all previous information so the state
(including any previously spread user tags) will be completely restored by a
later call to <a href="#restore_tag/1"><code class="inline">restore_tag/1</code></a>.</p><p>The <a href="../../apps/kernel/file.html"><code class="inline">file</code></a> module already spread's tags, so there is no need to manually call
these function to get user tags spread to the efile driver through that module.</p><p>The most use of this function would be if one for example uses the <a href="../../apps/stdlib/io.html"><code class="inline">io</code></a> module
to communicate with an I/O-server for a regular file, like in the following
example:</p><pre><code class="makeup erlang" translate="no"><span class="nf">f</span><span class="p" data-group-id="3814661618-1">(</span><span class="p" data-group-id="3814661618-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="3814661618-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p" data-group-id="3814661618-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">file</span><span class="p">:</span><span class="nf">open</span><span class="p" data-group-id="3814661618-3">(</span><span class="s">&quot;test.tst&quot;</span><span class="p">,</span><span class="p" data-group-id="3814661618-4">[</span><span class="ss">write</span><span class="p" data-group-id="3814661618-4">]</span><span class="p" data-group-id="3814661618-3">)</span><span class="p">,</span><span class="w">
   </span><span class="n">Saved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">dyntrace</span><span class="p">:</span><span class="nf">spread_tag</span><span class="p" data-group-id="3814661618-5">(</span><span class="ss">true</span><span class="p" data-group-id="3814661618-5">)</span><span class="p">,</span><span class="w">
   </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="3814661618-6">(</span><span class="n">F</span><span class="p">,</span><span class="s">&quot;Hello world!&quot;</span><span class="p">,</span><span class="p" data-group-id="3814661618-7">[</span><span class="p" data-group-id="3814661618-7">]</span><span class="p" data-group-id="3814661618-6">)</span><span class="p">,</span><span class="w">
   </span><span class="nc">dyntrace</span><span class="p">:</span><span class="nf">restore_tag</span><span class="p" data-group-id="3814661618-8">(</span><span class="n">Saved</span><span class="p" data-group-id="3814661618-8">)</span><span class="p">,</span><span class="w">
   </span><span class="nc">file</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="3814661618-9">(</span><span class="n">F</span><span class="p" data-group-id="3814661618-9">)</span><span class="p">.</span></code></pre><p>In this example, any user tag set in the calling process will be spread to the
I/O-server when the io:format call is done.</p>
  </section>
</section>

    </div>
  </section>

      <footer class="footer">
        <p>

          <span class="line">
            <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
              Search HexDocs
            </button>

              <a href="runtime_tools.epub" title="ePub version">
                Download ePub version
              </a>

          </span>
        </p>

        <p class="built-using">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.31.1) for the

            <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

        </p>
      </footer>
    </div>
  </div>
</main>
</div>


  </body>
</html>
